# Unraid Monitor Bot Configuration

monitoring:
  health_check_interval: 60  # seconds (used in Phase 2)

# AI / Claude API configuration
ai:
  models:
    pattern_analyzer: "claude-haiku-4-5-20251001"
    nl_processor: "claude-sonnet-4-5-20250929"
    diagnostic: "claude-haiku-4-5-20251001"
  max_tokens:
    pattern_analyzer: 500
    nl_processor: 1024
    diagnostic_brief: 300
    diagnostic_detail: 800
  nl_processor:
    max_tool_iterations: 10
    max_conversation_exchanges: 5
  pattern_analyzer_context_lines: 30
  diagnostic_context_expiry_seconds: 600

# Bot display and behaviour settings
bot:
  confirmation_timeout_seconds: 60
  log_display:
    max_lines: 100
    max_chars: 4000
    nl_max_chars: 3000
    diagnose_max_lines: 500
  error_display_max_chars: 200

# Docker connection settings
docker:
  socket_path: "unix:///var/run/docker.sock"

# Containers to ignore (won't be monitored or shown)
ignored_containers:
  - Kometa

# Containers that cannot be controlled via Telegram
# (restart/stop/start/pull commands will be rejected)
protected_containers:
  - unraid-monitor-bot

# Log watching configuration for Phase 2 alerts
log_watching:
  # Containers to watch for log errors
  containers:
    - plex
    - radarr
    - sonarr
    - lidarr
    - readarr
    - prowlarr
    - qbit
    - sab
    - tautulli
    - overseerr
    - mariadb
    - postgresql14
    - redis
    - brisbooks
    - CouchDB

  # Patterns to match as errors (case-insensitive)
  error_patterns:
    - "error"
    - "exception"
    - "fatal"
    - "failed"
    - "critical"
    - "panic"
    - "traceback"

  # Patterns to ignore even if they match error patterns
  ignore_patterns:
    - "DeprecationWarning"
    - "DEBUG"
    - "INFO"

  # Cooldown period before alerting on same error again (seconds)
  cooldown_seconds: 900

unraid:
  enabled: true
  host: "192.168.0.190"
  port: 80              # HTTP port (default)
  use_ssl: false        # Use HTTP instead of HTTPS
  verify_ssl: false     # Only applies if use_ssl: true
  polling:
    system: 30          # System metrics (CPU, memory) poll interval in seconds
    array: 300          # Array/disk metrics poll interval in seconds
    ups: 60             # UPS status poll interval in seconds
  thresholds:
    cpu_temp: 80        # CPU temperature threshold in degrees C
    cpu_usage: 95       # CPU usage threshold in percent
    memory_usage: 90    # Memory usage threshold in percent
    disk_temp: 50       # Disk temperature threshold in degrees C
    array_usage: 85     # Array usage threshold in percent
    ups_battery: 30     # UPS battery threshold in percent

# Memory pressure management
memory_management:
  enabled: false  # Set to true to enable
  warning_threshold: 90
  critical_threshold: 95
  safe_threshold: 80
  kill_delay_seconds: 60
  stabilization_wait: 180
  priority_containers:
    - plex
    - mariadb
    - postgresql14
  killable_containers: []  # Add containers that can be killed, in kill order 